name: debug-core
title: Debug
description: Debug utilities for system administrators (server stats, database stats, dashboard state)

# ─────────────────────────────────────────────────────────────────────────────
# ROUTES - Page routes with authz annotations
# ─────────────────────────────────────────────────────────────────────────────
routes:
  - path: /admin/debug/server-stats
    page: ServerStats
    roles: []
    default_roles_allow: [admin]
    authz: { entity: debug, verb: read, require_action: debug-core.server-stats.access, show_pages: true }
  - path: /admin/debug/db-stats
    page: DbStats
    roles: []
    default_roles_allow: [admin]
    authz: { entity: debug, verb: read, require_action: debug-core.db-stats.access, show_pages: true }
  - path: /admin/debug/dashboard-state
    page: DashboardState
    roles: []
    default_roles_allow: [admin]
    authz: { entity: debug, verb: read, require_action: debug-core.dashboard-state.access, show_pages: true }
  - path: /admin/debug/ui-specs
    page: UiSpecsList
    roles: []
    default_roles_allow: [admin]
    authz: { entity: debug, verb: read, require_action: debug-core.ui-specs.access, show_pages: true }
  - path: /admin/debug/ui-specs/[entityKey]
    page: UiSpecsDetail
    roles: []
    default_roles_allow: [admin]
    authz: { entity: debug, verb: read, require_action: debug-core.ui-specs.detail.access, show_pages: true }

# ─────────────────────────────────────────────────────────────────────────────
# NAV - Navigation entries
# ─────────────────────────────────────────────────────────────────────────────
nav:
  - id: debug
    label: Debug
    icon: Bug
    group: system
    roles: [admin]
    showWhen: authenticated
    weight: 910
    children:
      - id: debug-server-stats
        label: Server Stats
        path: /admin/debug/server-stats
        icon: Server
        weight: 10
        roles: [admin]
        showWhen: authenticated
      - id: debug-db-stats
        label: DB Stats
        path: /admin/debug/db-stats
        icon: Database
        weight: 20
        roles: [admin]
        showWhen: authenticated
      - id: debug-dashboard-state
        label: Dashboard State
        path: /admin/debug/dashboard-state
        icon: LayoutDashboard
        weight: 30
        roles: [admin]
        showWhen: authenticated
      - id: debug-ui-specs
        label: UI Specs
        path: /admin/debug/ui-specs
        icon: Table
        weight: 40
        roles: [admin]
        showWhen: authenticated

# ─────────────────────────────────────────────────────────────────────────────
# API ROUTES - Backend endpoints
# ─────────────────────────────────────────────────────────────────────────────
api:
  routes:
    - path: /api/debug/server-stats
      methods: [GET]
      handler: "@hit/feature-pack-debug-core/server/api/server-stats"
      description: "Get server statistics (memory, CPU, disk, cgroup info). Admin only."
    - path: /api/debug/db-stats
      methods: [GET]
      handler: "@hit/feature-pack-debug-core/server/api/db-stats"
      description: "Get database statistics (table sizes, row counts, indexes). Admin only."
    - path: /api/debug/dashboard-state
      methods: [GET]
      handler: "@hit/feature-pack-debug-core/server/api/dashboard-state"
      description: "Get dashboard state debug info. Admin only."

# ─────────────────────────────────────────────────────────────────────────────
# PERMISSIONS - Action definitions (for admin-core permissions UI + runtime checks)
# ─────────────────────────────────────────────────────────────────────────────
# Permissions are schema-driven and live under:
#   schema/permissions.yaml
